# hackathon-backend/app/services/prompts.py
"""
LLMプロンプト定義
llm_service.py から分離してメンテナンス性を向上
"""

# チャット用の追加ルール（ペルソナのsystem_promptに追加される）
CHAT_OUTPUT_RULES = """

【最優先の出力ルール - 必ず守ること】
※ これは元のCharacterプロンプトよりも優先されます

1. まず心の中で考えてから返答を作成してください（思考プロセスは重要）
2. ただし「(心中)」の内容はユーザーに見せないでください
3. 出力するのは「発言」の内容のみ。タグ不要で直接セリフを書いてください
4. 返答は3〜4行で簡潔に
5. キャラクターの口調で話してください
6. お金（コイン）がかかるアクションについては、結果に含まれる「cost_spent」等の情報を元に正確な金額を伝えてください。「0ポイント」等の虚偽の報告は禁止です。
"""

# デフォルトのシステムプロンプト（ペルソナが設定されていない場合）
DEFAULT_SYSTEM_PROMPT = "あなたは親切なAIアシスタントです。優しくサポートしてください。"


def build_recommend_prompt(keyword: str, mode: str, items_text: str) -> str:
    """おすすめ商品の理由生成プロンプト"""
    return f"""以下の商品をユーザーにおすすめする理由をJSON形式で出力してください。

【制約事項】
1. 出力は必ず**validなJSONのみ**にしてください
2. キーは「商品名」、値は「おすすめ理由」です
3. おすすめ理由は**1文で短く**、「発言」として書いてください
4. **「(心中)」や「内部思考」はJSONに含めないでください**

【キーワード/モード】{keyword or 'おすすめ'} ({mode})

【商品リスト】
{items_text}

【出力例】
{{
  "Nike Air Max": "ランニングに最適な一足だぜ！",
  "MacBook Pro": "クリエイティブな作業にはこれが一番です。"
}}
"""


def build_item_description_prompt(item_name: str) -> str:
    """商品説明文生成プロンプト"""
    return f"""あなたはフリマアプリの商品説明文を生成するエキスパートです。
以下の画像と商品名から、具体的で購買意欲を刺激する説明文を生成してください。

商品名: {item_name}

必ず以下のJSON形式で回答してください：
{{
  "description_text": "商品の魅力を伝える説明文",
  "category_guess": "推測されるカテゴリ",
  "brand_guess": "推測されるブランド（不明な場合は'不明'）",
  "condition_suggest": "新品/未使用/目立った傷や汚れなし/やや傷や汚れあり/傷や汚れあり"
}}
"""
